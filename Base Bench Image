Write-Host "Beginning Base Bench Setup... Sit tight, this may take a little while!!!!!!" -ForegroundColor Red -BackgroundColor Yellow
Write-Host "Renaming Computer" -ForegroundColor Red -BackgroundColor Yellow
$SN = Get-WmiObject win32_bios | Select -ExpandProperty SerialNumber
Rename-Computer -NewName 'RenameMe-$SN'
Write-Host "Computer Renamed to RenameMe-$SN" -ForegroundColor Red -BackgroundColor Yellow
Clear-Host


Write-Host "Installing Connectwise Automate. Please be sure to move to proper company" -ForegroundColor Red -BackgroundColor Yellow
Start-Process C:\Utils\CatchallAutomate.msi -ArgumentList '/qn'
Clear-Host


Write-Host "Removing all OEM Bloatware" -ForegroundColor Red -BackgroundColor Yellow
$MicrosoftBloatwareApps = Get-AppxPackage | Where PackageFullName -NotLike *Store*
foreach ($MicrosoftBloatwareApp in $MicrosoftBloatwareApps) {
            $PackageFullName = $MicrosoftBloatwareApp.PackageFullName
            Remove-AppxPackage -package $PackageFullName -confirm:$false -ErrorAction SilentlyContinue
            Clear-Host
                                                            }
$WindowsPCHealthCheck = Get-WmiObject win32_product | Where Name -Like "Windows PC Health Check"
$WindowsPCHealthCheck.Uninstall()
$McAfee = Get-WmiObject win32_product | Where Vendor -Like "*McAfee*"
$McAfee.Uninstall()
Clear-Host


Write-Host "Installing Base Applications" -ForegroundColor Red -BackgroundColor Yellow
Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))
choco upgrade chocolatey -force -y
choco upgrade adobereader -force -y
choco upgrade googlechrome -force -y
choco upgrade firefox -force -y
choco upgrade microsoft-teams.install -force -y
choco upgrade 7zip.install -force -y
choco upgrade microsoft-edge -force -y
choco upgrade zoom -force -y
choco upgrade vlc -force -y
choco upgrade 7zip -force -y
choco upgrade powershell -force -y
choco upgrade office365business --params "'/productid:O365BusinessRetail /exclude: Groove Lync Skype /language:en-US /updates:TRUE /eula:FALSE'" -force -y
#choco upgrade microsoft-office-deployment /64bit /DisableUpdate FALSE /Channel Current /Language en-us /Product O365BusinessRetail
choco upgrade dotnetfx -force -y
Clear-Host


Write-Host "Installing Manufacturer driver support software. Also, installing driver and BIOS updates." -ForegroundColor Red -BackgroundColor Yellow
$Manufacturer = Get-WmiObject win32_bios | Select -ExpandProperty Manufacturer
New-Item -Path C:\ -Name Utils -ItemType Directory -Force -ErrorAction SilentlyContinue
Write-Host "Determined the Manufacturer of this workstation is $Manufacturer. Proceeding with correct driver software." -ForegroundColor Red -BackgroundColor Yellow

If ($Manufacturer -like '*Dell*') {
         Write-Host "Installing Dell Command Update. Updating drivers and BIOS." -ForegroundColor Red -BackgroundColor Yellow
         Set-ExecutionPolicy -ExecutionPolicy Bypass -Force -Scope Process
         [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
         choco upgrade dellcommandupdate -force -y
         Start-Sleep -Seconds 60
         Start-Service -Name DellClientManagementService

         $DCU_x86 = "C:\Program Files (x86)\Dell\CommandUpdate\dcu-cli.exe"
         $DCU_x64 = "C:\Program Files\Dell\CommandUpdate\dcu-cli.exe"

     If ($DCU_x86 -eq $true){

                    Start-Process "C:\Program Files (x86)\Dell\CommandUpdate\dcu-cli.exe" -ArgumentList "/applyUpdates"

                        }

     If ($DCU_x64 -eq $true){

                    Start-Process "C:\Program Files\Dell\CommandUpdate\dcu-cli.exe" -ArgumentList "/applyUpdates"

                        }
                                 }

If ($Manufacturer -like '*Lenovo*') {

       choco upgrade lenovo-thinkvantage-system-update -force -y
                    Write-Host "Installing Lenovo System Update. Updating drivers and BIOS." -ForegroundColor Red -BackgroundColor Yellow
                    Start-Sleep -Seconds 60
                    Start-Process "C:\Program Files (x86)\Lenovo\System Update\Tvsu.exe" -ArgumentList "/CM -search A -action INSTALL -noicon -includerebootpackages 1,3,4 -noreboot"

}

If ($Manufacturer -like '*HP*' -or '*Hewlett*') {

        choco upgrade hpsupportassistant -force -y
                    Write-Host "Installing HP Support Assistant. Updating drivers and BIOS." -ForegroundColor Red -BackgroundColor Yellow
                    Start-Sleep -Seconds 60
                    Start-Process "C:\Utils\HPSA8\InstallHPSA.exe" -ArgumentList "/S /v/qn"

}
Clear-Host


Write-Host "Installing PSWindowsUpdate Module. Installing ALL available Windows and Optional Updates, including any feature updates." -ForegroundColor Red -BackgroundColor Yellow
Set-ExecutionPolicy -ExecutionPolicy Bypass -Force -Scope Process
[System.Net.ServicePointManager]::SecurityProtocol = [System.Net.SecurityProtocolType]::Tls12
Install-PackageProvider -Name NuGet -Force
Install-Module -Name PSWindowsUpdate -Force
Import-Module PSWindowsUpdate; Install-WindowsUpdate -AcceptAll -Install -AutoReboot
Clear-Host


Write-Host "Base Bench Setup script has completed. Restarting computer in 10 seconds!" -ForegroundColor Red -BackgroundColor Yellow
Start-Sleep -Seconds 1
Clear-Host
Write-Host "Base Bench Setup script has completed. Restarting computer in 9 seconds!" -ForegroundColor Red -BackgroundColor Yellow
Start-Sleep -Seconds 1
Clear-Host
Write-Host "Base Bench Setup script has completed. Restarting computer in 8 seconds!" -ForegroundColor Red -BackgroundColor Yellow
Start-Sleep -Seconds 1
Clear-Host
Write-Host "Base Bench Setup script has completed. Restarting computer in 7 seconds!" -ForegroundColor Red -BackgroundColor Yellow
Start-Sleep -Seconds 1
Clear-Host
Write-Host "Base Bench Setup script has completed. Restarting computer in 6 seconds!" -ForegroundColor Red -BackgroundColor Yellow
Start-Sleep -Seconds 1
Clear-Host
Write-Host "Base Bench Setup script has completed. Restarting computer in 5 seconds!" -ForegroundColor Red -BackgroundColor Yellow
Start-Sleep -Seconds 1
Clear-Host
Write-Host "Base Bench Setup script has completed. Restarting computer in 4 seconds!" -ForegroundColor Red -BackgroundColor Yellow
Start-Sleep -Seconds 1
Clear-Host
Write-Host "Base Bench Setup script has completed. Restarting computer in 3 seconds!" -ForegroundColor Red -BackgroundColor Yellow
Start-Sleep -Seconds 1
Clear-Host
Write-Host "Base Bench Setup script has completed. Restarting computer in 2 seconds!" -ForegroundColor Red -BackgroundColor Yellow
Start-Sleep -Seconds 1
Clear-Host
Write-Host "Base Bench Setup script has completed. Restarting computer in 1 seconds!" -ForegroundColor Red -BackgroundColor Yellow
Start-Sleep -Seconds 1
Clear-Host
Restart-Computer -Force
Exit